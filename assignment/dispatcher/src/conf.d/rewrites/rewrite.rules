#
# This file contains the rewrite rules, and can be customized.
#
# By default, it includes just the rewrite rules. You can
# add rewrite rules to this file but you should still include
# the default rewrite rules.

Include conf.d/rewrites/default_rewrite.rules

# rewrite for root redirect
RewriteRule ^/?$ /content/${CONTENT_FOLDER_NAME}/us/en.html [PT,L]

RewriteCond %{REQUEST_URI} !^/apps
RewriteCond %{REQUEST_URI} !^/bin
RewriteCond %{REQUEST_URI} !^/content
RewriteCond %{REQUEST_URI} !^/etc
RewriteCond %{REQUEST_URI} !^/home
RewriteCond %{REQUEST_URI} !^/libs
RewriteCond %{REQUEST_URI} !^/saml_login
RewriteCond %{REQUEST_URI} !^/system
RewriteCond %{REQUEST_URI} !^/tmp
RewriteCond %{REQUEST_URI} !^/var
RewriteCond %{REQUEST_URI} !^/conf/(.+\.jpe?g|.+\.png|.+\.svg)$
RewriteCond %{REQUEST_URI} (.html|.jpe?g|.png|.svg)$
RewriteRule ^/(.*)$ /content/${CONTENT_FOLDER_NAME}/$1 [PT,L]


# Enable rewrite engine
RewriteEngine On

# Rule 1: Redirect for English (US) blogs with parameters (?lang=en&region=us)
RewriteCond %{QUERY_STRING} ^lang=en&region=us$
RewriteRule ^/articles/(.*)$ /content/assignment/us/en/blogs/$1.html [R=301,L]

# Rule 2: Redirect for French (Canada) blogs with parameters (?lang=fr&region=ca)
RewriteCond %{QUERY_STRING} ^lang=fr&region=ca$
RewriteRule ^/articles/(.*)$ /content/assignment/ca/fr/blogs/$1.html [R=301,L]

# Rule 3: Default case if no language or region is provided (/articles/blog-id)
RewriteCond %{QUERY_STRING} !lang= [NC]
RewriteCond %{QUERY_STRING} !region= [NC]
RewriteRule ^/articles/(.*)$ /content/assignment/us/en/blogs/$1.html [R=301,L]